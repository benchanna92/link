<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Phone Software Repair Auto-Reply Box</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');

  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    font-family: 'Inter', sans-serif;
    background: #f5f7fa;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  /* Auto Reply Box Container */
  .auto-reply-box {
    position: fixed;
    bottom: 24px;
    right: 24px;
    width: 320px;
    max-width: 90vw;
    background: #20232a;
    color: #e1e4ea;
    border-radius: 16px;
    box-shadow: 0 12px 32px rgba(0,0,0,0.3);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    font-size: 14px;
    user-select: none;
  }

  .auto-reply-header {
    background: #24292e;
    padding: 16px;
    font-weight: 600;
    font-size: 18px;
    color: #61dafb;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .close-btn {
    background: transparent;
    border: none;
    color: #61dafb;
    font-size: 22px;
    cursor: pointer;
    line-height: 1;
    padding: 0;
    user-select: none;
    transition: color 0.3s ease;
  }
  .close-btn:hover,
  .close-btn:focus {
    color: #21a1f1;
    outline: none;
  }

  .chat-window {
    background: #20232a;
    padding: 16px;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: #61dafb transparent;
  }
  .chat-window::-webkit-scrollbar {
    width: 8px;
  }
  .chat-window::-webkit-scrollbar-thumb {
    background-color: #61dafb;
    border-radius: 4px;
  }
  .chat-window::-webkit-scrollbar-track {
    background: transparent;
  }

  .message {
    max-width: 80%;
    margin-bottom: 12px;
    padding: 12px 16px;
    border-radius: 16px;
    line-height: 1.4;
  }

  .message.user {
    background: #61dafb;
    color: #20232a;
    align-self: flex-end;
    border-bottom-right-radius: 4px;
    box-shadow: 0 2px 6px rgba(97,218,251,0.5);
  }

  .message.auto-reply {
    background: #2d333b;
    align-self: flex-start;
    border-bottom-left-radius: 4px;
    box-shadow: 0 2px 6px rgba(101,114,133,0.5);
  }

  .chat-input-area {
    display: flex;
    border-top: 1px solid #3c4048;
    background: #24292e;
  }

  .chat-input-area input[type="text"] {
    flex-grow: 1;
    border: none;
    padding: 14px 16px;
    font-size: 14px;
    border-radius: 0 0 0 16px;
    color: #e1e4ea;
    background: #20232a;
  }
  .chat-input-area input[type="text"]::placeholder {
    color: #6b7280;
  }
  .chat-input-area input[type="text"]:focus {
    outline: none;
    background: #24292e;
  }

  .chat-input-area button {
    background: #61dafb;
    border: none;
    color: #20232a;
    font-weight: 600;
    padding: 0 24px;
    font-size: 14px;
    cursor: pointer;
    border-radius: 0 0 16px 0;
    transition: background-color 0.3s ease;
  }

  .chat-input-area button:hover,
  .chat-input-area button:focus {
    background: #21a1f1;
    outline: none;
  }

  /* Responsive */
  @media (max-width: 400px) {
    .auto-reply-box {
      width: 95vw;
      bottom: 12px;
      right: 12px;
    }
  }
</style>
</head>
<body>
  <div class="auto-reply-box" role="region" aria-label="Phone repair auto reply chatbox" aria-live="polite" aria-atomic="true">
    <div class="auto-reply-header">
      <span>Phone Repair Support</span>
      <button class="close-btn" aria-label="Close chatbox" title="Close chatbox">&times;</button>
    </div>
    <div class="chat-window" id="chatWindow" role="log" aria-live="polite" aria-relevant="additions"></div>
    <form class="chat-input-area" id="chatForm" aria-label="Send message form">
      <input type="text" id="chatInput" aria-label="Type your message" placeholder="Type your message..." autocomplete="off" required />
      <button type="submit" aria-label="Send message">Send</button>
    </form>
  </div>

<script>
  (function() {
    const chatWindow = document.getElementById('chatWindow');
    const chatForm = document.getElementById('chatForm');
    const chatInput = document.getElementById('chatInput');
    const closeBtn = document.querySelector('.close-btn');
    const box = document.querySelector('.auto-reply-box');

    // Predefined auto-reply rules - simple matching keywords with replies
    const autoReplies = [
      {
        keywords: ['screen', 'crack', 'broken', 'display'],
        reply: "If your phone screen is cracked or broken, we can replace it quickly with high-quality parts. Would you like to schedule a repair?"
      },
      {
        keywords: ['battery', 'charge', 'power', 'drain'],
        reply: "Battery issues? We offer fast battery replacement and diagnostic services. How can I help you with your battery today?"
      },
      {
        keywords: ['software', 'update', 'error', 'crash', 'freeze'],
        reply: "Software problems can often be fixed with a system reset or update. Can you describe the issue you're experiencing?"
      },
      {
        keywords: ['water', 'liquid', 'damage', 'wet'],
        reply: "Water damage is serious. We advise you to stop using the phone and bring it in for an immediate assessment."
      },
      {
        keywords: ['price', 'cost', 'repair', 'quote', 'estimate'],
        reply: "Pricing depends on the specific repair needed. Can you please specify the problem or your phone model?"
      },
      {
        keywords: ['hello', 'hi', 'hey', 'greetings'],
        reply: "Hello! How can we assist you with your phone repair needs today?"
      },
      {
        keywords: ['thank', 'thanks', 'great', 'good'],
        reply: "You're welcome! Feel free to ask if you have any more questions."
      }
    ];

    // Default reply if no keyword matched
    const defaultReply = "Thanks for reaching out! Can you please provide more details about your phone issue?";

    // Helper to sanitize input and make case insensitive
    function textIncludesKeywords(text, keywords) {
      text = text.toLowerCase();
      return keywords.some(keyword => text.includes(keyword));
    }

    // Create message element
    function createMessage(text, type = 'auto-reply') {
      const msgElem = document.createElement('div');
      msgElem.classList.add('message', type);
      msgElem.textContent = text;
      return msgElem;
    }

    // Append message and scroll chat to bottom
    function appendMessage(msgElem) {
      chatWindow.appendChild(msgElem);
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    // On form submit: user sends message, then auto reply triggered
    chatForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const userMessage = chatInput.value.trim();
      if (!userMessage) return;

      // Append user message
      appendMessage(createMessage(userMessage, 'user'));

      // Clear input
      chatInput.value = '';
      chatInput.disabled = true; // temporarily disable input during reply

      // Simulate typing delay for auto-reply
      setTimeout(() => {
        let replied = false;
        for (const rule of autoReplies) {
          if (textIncludesKeywords(userMessage, rule.keywords)) {
            appendMessage(createMessage(rule.reply, 'auto-reply'));
            replied = true;
            break;
          }
        }
        if (!replied) {
          appendMessage(createMessage(defaultReply, 'auto-reply'));
        }
        chatInput.disabled = false;
        chatInput.focus();
      }, 900);
    });

    // Close button hides the chat box
    closeBtn.addEventListener('click', () => {
      box.style.display = 'none';
    });

    // Initialize with a greeting auto message
    appendMessage(createMessage("Hi! I'm your phone repair assistant. How can I help you today?", 'auto-reply'));
  })();
</script>
</body>
</html>

